sudo: required
services:
  - docker

before_install:
  - docker-compose -f docker-compose.dev.yml build

script:
  - docker-compose -f docker-compose.dev.yml up -d
  - docker-compose -f docker-compose.dev.yml exec db psql -U postgres -d postgres -c "ALTER USER postgres WITH PASSWORD 'password';"
  - docker-compose -f docker-compose.dev.yml exec db psql -U postgres -c "CREATE DATABASE emailservice;"
  - docker-compose -f docker-compose.dev.yml exec db psql -U postgres -c "CREATE DATABASE test;"
  - docker-compose -f docker-compose.dev.yml exec nest sh -c "npm run test"
